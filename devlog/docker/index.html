<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 3.2.0">
  <meta name="generator" content="Hugo 0.52" />
  <meta name="author" content="Michael Pilosov">

  
  
  
  
    
  
  <meta name="description" content="JupyterHub Day!!">

  
  <link rel="alternate" hreflang="en-us" href="https://www.michaelpilosov.com/devlog/docker/">

  


  

  

  

  

  

  

  
  
  
  <meta name="theme-color" content="hsl(339, 90%, 68%)">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css" crossorigin="anonymous">
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  

  <link rel="stylesheet" href="/styles.css">
  
  <link rel="stylesheet" href="/css/custom_css.css">
  
  <link rel="stylesheet" href="/css/style.css">
  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-122657370-3', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  
  <link rel="alternate" href="https://www.michaelpilosov.com/index.xml" type="application/rss+xml" title="Michael Pilosov: The Archives">
  <link rel="feed" href="https://www.michaelpilosov.com/index.xml" type="application/rss+xml" title="Michael Pilosov: The Archives">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://www.michaelpilosov.com/devlog/docker/">

  
  
  
  
    
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@Mathematical_MP">
  <meta property="twitter:creator" content="@Mathematical_MP">
  
  <meta property="og:site_name" content="Michael Pilosov: The Archives">
  <meta property="og:url" content="https://www.michaelpilosov.com/devlog/docker/">
  <meta property="og:title" content="Early Exploration with Docker &amp; Kubernetes | Michael Pilosov: The Archives">
  <meta property="og:description" content="JupyterHub Day!!"><meta property="og:image" content="https://www.michaelpilosov.com/img/logo-dark.png">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-12-24T00:00:00-07:00">
  
  <meta property="article:modified_time" content="2019-01-01T14:43:00-07:00">
  

  

  

  <title>Early Exploration with Docker &amp; Kubernetes | Michael Pilosov: The Archives</title>

</head>
<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" class="dark">
  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" role="textbox" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/"><img src="/img/logo-dark.png" alt="Michael Pilosov: The Archives"></a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#about">
            
            <span>About</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#resume">
            
            <span>Résumé</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        

      </ul>

    </div>
  </div>
</nav>



<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" id="search-query" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/devlog/academicupgrades/">Website</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/devlog/academicupgrades/">Upgrading</a>
      </li>
      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/devlog/">devlog</a>
    <ul class="nav docs-sidenav">
      
      <li class="active">
        <a href="/devlog/docker/">Phase 0</a>
      </li>
      
      <li >
        <a href="/devlog/openscience/">Phase 1</a>
      </li>
      
      <li >
        <a href="/devlog/jupyterhub/">Phase 2</a>
      </li>
      
      <li >
        <a href="/devlog/widgets/">Widgets</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      
      <p class="docs-toc-title">On this page</p>
      

      <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#deploying-jupyter-notebooks-for-students-and-researchers-pydata-2016">Deploying Jupyter Notebooks for Students and Researchers (PyData 2016)</a></li>
<li><a href="#managing-a-1000-student-jupyterhub-without-losing-your-sanity-jupytercon-2018">Managing a 1000+ Student JupyterHub without Losing your Sanity (JupyterCon 2018)</a></li>
<li><a href="#scaling-jupyterhub-to-many-users-pydata-tel-aviv-2018">Scaling JupyterHub to many users (PyData Tel-Aviv 2018)</a></li>
<li><a href="#jupyterhub-and-jupyterlab-perfect-together-pydata-2018">&ldquo;JupyterHub and JupyterLab: Perfect Together (PyData 2018)&rdquo;</a></li>
<li><a href="#jupyterhub-with-kubernetes">JupyterHub with Kubernetes:</a></li>
<li><a href="#log">Log</a></li>
</ul></li>
<li><a href="#docker-jupyter-stacks">Docker Jupyter Stacks</a></li>
<li><a href="#the-correct-way">The &ldquo;Correct Way&rdquo;</a></li>
</ul>
</nav>

      <ul class="nav toc-top">
        <li><a href="#">Back to top</a></li>
      </ul>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article" itemscope itemtype="http://schema.org/Article">

        <div class="docs-article-container">
          <h1 itemprop="name">Early Exploration with Docker &amp; Kubernetes</h1>

          <div class="article-style" itemprop="articleBody">
            

<p>Dec 22, 2018
Today I began to structure and fill in the basic information for the <a href="/openscience/docker">Open Science/Docker</a> Documentation.</p>

<p>12/24/2019 - 01/01/2019</p>

<p>Today I started by watching a video to be aware of the problems I might face going forward with JupyterHub.
I watched someone from Berkeley describe how they&rsquo;ve scaled to thousands of users across many professors and managed to not grow their IT team while doing so.</p>

<p>I will start by using this space here to take notes on the following video(s):</p>

<h2 id="deploying-jupyter-notebooks-for-students-and-researchers-pydata-2016">Deploying Jupyter Notebooks for Students and Researchers (PyData 2016)</h2>


<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="//www.youtube.com/embed/gSVvxOchT8Y" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>


<hr />

<h2 id="managing-a-1000-student-jupyterhub-without-losing-your-sanity-jupytercon-2018">Managing a 1000+ Student JupyterHub without Losing your Sanity (JupyterCon 2018)</h2>


<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="//www.youtube.com/embed/ivswAxysfTk" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>


<p>Here are the stated goals in the video:</p>

<ul>
<li>[7:30] Infrastructure Shouldn&rsquo;t Bottleneck

<ul>
<li>Instructors should be able to install packages as needed</li>
</ul></li>
<li>[8:00] Anyone can Deploy

<ul>
<li>Treat Admins as Equal (grad students, teachers, etc)</li>
</ul></li>
<li>[9:00] Automate Workflows

<ul>
<li>Avoid manual processes. No one-off scripts to bootstrap solutions</li>
</ul></li>
<li>[9:30] Reduce Human Maintenance

<ul>
<li>Build on top of tools that already exist</li>
<li>Let academic edit Dockerfile directly on Github, issue pull-request.</li>
<li>Travis Process builds image, and if successful, requests to merge</li>
<li>Rather than CLI, hit a couple buttons to set off other Travis Processes to update Helm</li>
</ul></li>
<li>[13:55]: Reproducibility

<ul>
<li>Tag versions, everything.</li>
<li>The release cycles of the core infrastructure components do not align with each other.</li>
<li>In pip file, in Dockerfile, all of it.</li>
<li>Get git hashes for latest commits.</li>
<li>Tag Docker images with the hashes of the repositories that generated them</li>
<li>This makes it much easier to re-deploy!</li>
</ul></li>
<li>[15:30] Horror Story of Hub failing during Finals week because a Cloud bill was unpaid (grant ran out)

<ul>
<li>All the versioning helped saved them</li>
<li>Despite coming up on different nodes, the same hub came out of it.</li>
</ul></li>
<li>[17:00] Observability

<ul>
<li>Monitoring (container provider may have analytics)</li>
<li><em>This may be less of a problem for us if we deploy on our own servers.</em></li>
<li>Figure out needs of students to figure out how many nodes.</li>
<li>After observing, they noticed most students used under 1GB, allowing them to double capacity per node. Students that went above were writing runaway processes anyway.</li>
</ul></li>
<li>[19:30] Incident Reporting

<ul>
<li>any time something goes down, write a report.</li>
<li>[Incident Reports at Berkeley][github.com/data-8/infrastructure]</li>
<li>Improves deployment.</li>
<li>Event summary, timeline, conclusion, and action items.</li>
<li>Reports are &ldquo;blameless&rdquo; to encourage transparency with relevant details</li>
</ul></li>
<li>[21:30] Generalization

<ul>
<li>Be a good open-source citizen</li>
<li>This means digging into problems and reporting bugs</li>
<li>Not every problem is your fault. Sometimes an upstream thing breaks it, and if you report it, you may save other people time/effort.</li>
<li>Don&rsquo;t rely on forks and custom patches. Contribute. Think about reproducible deployment scenarios.</li>
</ul></li>
<li>[24:30] Contact Information (encouraged)

<ul>
<li><a href="mailto:rylo@berkeley.edu" target="_blank">Ryan Lovett</a></li>
<li><a href="mailto:yuvipanda@berkeley.edu" target="_blank">Yuvi Panda</a>
<br /></li>
</ul></li>
</ul>

<hr />

<h2 id="scaling-jupyterhub-to-many-users-pydata-tel-aviv-2018">Scaling JupyterHub to many users (PyData Tel-Aviv 2018)</h2>


<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="//www.youtube.com/embed/QN8T9zdnyLc" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>


<hr />

<h2 id="jupyterhub-and-jupyterlab-perfect-together-pydata-2018">&ldquo;JupyterHub and JupyterLab: Perfect Together (PyData 2018)&rdquo;</h2>


<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="//www.youtube.com/embed/AXCo39qMn1E" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>


<hr />

<h2 id="jupyterhub-with-kubernetes">JupyterHub with Kubernetes:</h2>


<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="//www.youtube.com/embed/uiLUmuecU7I" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>


<hr />

<hr />

<hr />

<h2 id="log">Log</h2>

<p>A lot of solutions exist for using docker to handle the file storage and user authentication.</p>

<p>Here is the solution that I think will work best for workshops:</p>

<p><a href="https://opendreamkit.org/2018/10/17/jupyterhub-docker/" target="_blank">Open DreamKit</a></p>

<hr />

<p>[11:37 AM] Pilosov, Michael</p>

<p>Okay, can&rsquo;t confirm until I try it, but I am reasonably certain that while this set-up is useful in many contexts.
It doesn&rsquo;t address the teacher/student/group collab management that we quite wanted (and that I focused on getting working first and have done already).
​</p>

<p>[11:39 AM] Pilosov, Michael</p>

<p>The way the build works here with data management is actually much &ldquo;slimmer&rdquo; in fact, and I think there&rsquo;s a use for it for us for sure&hellip; but I suspect it doesn&rsquo;t allow two users to share data, or a super-user to poke around in files.
​</p>

<p>[11:41 AM] Pilosov, Michael</p>

<p>But it would allow for secure authentication for like, a workshop, just using people&rsquo;s github accounts, and data-persistence and management would be more ideal in that sense since you can turn on permanence for each user, destroy it when the workshop is over as superuser (but without ever being able to poke around in their files, which is a nice security feature for the user I suppose&hellip;).</p>

<p>[11:52 AM] Pilosov, Michael</p>

<p>In short, what we want instead is for docker to launch up a virtual LINUX machine, where all memory persists within the container.
It&rsquo;s as if you set up a &ldquo;new computer&rdquo; for each class/workshop. Each class gets its own port.
Importantly, this makes &ldquo;management&rdquo; very familiar, identical to what you already know how to do, rather than having to &ldquo;learn docker&rdquo; to manage student&rsquo;s work.
also, updating things can be done this way without re-building images through docker. which is really nice for on-the-fly changes.</p>

<p><em>What&rsquo;s the downside you ask?</em>
It&rsquo;s definitely less memory efficient, but it&rsquo;s not a problem at all. we&rsquo;re talking like&hellip; cheap laptop levels of storage, nothing major.</p>

<hr />

<p>[12:20 AM]
Finished watching the first video and going throught he tutorial above for the most part.
I still think the Linux within each container is the simplest option for someone to manage on their own.
it is definitely the most familiar environment.</p>

<p>To start, let me <code>ssh</code> into my workstation and see if I can revive the docker container from the summer workshop. I will log my commands here!</p>

<pre><code class="language-bash"># start the server
docker run -td -p 80:8000 --name=labhub mathematicalmichael/labhub-test

# check that it is up
docker ps

# look for ip under process associated with your machine. look for 
# inet addr: &lt;XXX.XXX.XXX.XXX&gt;
</code></pre>

<p>Then we connect to auraria-anywhere via Cisco AnyConnect and attempt to connect to <XXX.XXX.XXX.XXX>:8000 via our browser.</p>

<div class="alert alert-warning">
  <p>This site can&rsquo;t be reached</p>

</div>


<p>Debug mode:</p>

<pre><code class="language-bash">docker logs labhub
</code></pre>

<p>showed me that</p>

<pre><code class="language-bash">Creating 3 new users...
Created user0 with password Breckenridge0_g2s3
Created user1 with password Breckenridge1_g2s3
Created user2 with password Breckenridge2_g2s3
*** Running /etc/rc.local...
*** Booting runit daemon...
*** Runit started as PID 66
*** Running jupyterhub --Spawner.cmd='jupyter-labhub' --no-ssl...
*** jupyterhub --Spawner.cmd='jupyter-labhub' --no-ssl exited with status 127.
*** Shutting down runit daemon (PID 66)...
*** Killing all processes...
</code></pre>

<p>So that tells me I messed up the .Dockerfile.
It might be instructive to just learn from what they did. I don&rsquo;t really need their libraries (which is what I believe was causing the build to fail before).</p>

<p>** It will definitely be better to start with a fresh Linux image and go from there, since we want to build on top of the newest release anyway, and make sure we understand how its done, keep images/layers light. **</p>

<p>From <a href="https://github.com/g2s3-2018/hippylib-hub" target="_blank">MUQ-Hippylib</a> (see <a href="https://bitbucket.org/mituq/" target="_blank">muq</a> for more info)</p>

<pre><code>FROM quay.io/fenicsproject/stable:2017.2.0.r3
MAINTAINER U. Villa

USER root

RUN apt-get update &amp;&amp; \
    apt-get install -yy pwgen npm nodejs-legacy python3-pip libgeos-dev&amp;&amp; \
    npm install -g configurable-http-proxy &amp;&amp; \
    pip3 install jupyterhub==0.8.1 &amp;&amp; \
    pip3 install ipython[notebook]==6.2.1 h5py pandas &amp;&amp; \
    pip install --user https://github.com/matplotlib/basemap/archive/master.zip

RUN apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*

#RUN mkdir /etc/certs
#RUN touch /etc/certs/ssl.key
#RUN touch /etc/certs/ssl.crt
#RUN openssl req -x509 -nodes -days 730 -newkey rsa:2048 \
#                 -subj &quot;/C=XY/ST=XYZ/L=XYZ/O=XYZ/CN=example.com&quot; \
#                 -keyout /etc/certs/ssl.key -out /etc/certs/ssl.crt

USER fenics

# Install MUQ
RUN cd /home/fenics &amp;&amp; \
    mkdir Installations; mkdir Installations/MUQ_INSTALL &amp;&amp; \
    git clone --depth 1 https://bitbucket.org/mituq/muq2.git &amp;&amp; \
    cd muq2/; mkdir build; cd build;  \
    cmake -DCMAKE_INSTALL_PREFIX=/home/fenics/Installations/MUQ_INSTALL -DMUQ_USE_PYTHON=ON ../ &amp;&amp; \
    make install

# Install hIPPYlib
RUN cd /home/fenics/Installations &amp;&amp; \
    git clone https://github.com/hippylib/hippylib.git &amp;&amp; \
    chmod -R o+rx hippylib

# Copy the notebooks
RUN cd /home/fenics/Installations &amp;&amp; \
    git clone https://github.com/g2s3-2018/labs.git

COPY python3_config.json /usr/local/share/jupyter/kernels/python3/kernel.json
ENV LD_LIBRARY_PATH /home/fenics/Installations/MUQ_INSTALL/lib:/home/fenics/Installations/MUQ_INSTALL/muq_external/lib
ENV PYTHONPATH /home/fenics/Installations/MUQ_INSTALL/lib:/home/fenics/Installations/hippylib

USER root

COPY jupyterhub_config.py /home/fenics/jupyterhub_config.py
COPY make-users-std-password.sh /etc/my_init.d/make-users-std-password.sh
RUN chmod +x /etc/my_init.d/make-users-std-password.sh
RUN rm /etc/my_init.d/set-home-permissions.sh
COPY update_lab.sh /home/fenics/update_lab.sh
RUN chmod +x /home/fenics/update_lab.sh
RUN mkdir -p /home/fenics/.jupyter
COPY jupyter_notebook_config.py /home/fenics/.jupyter/jupyter_notebook_config.py


ENV NUMBER_OF_USERS 60
WORKDIR /home/fenics/
ENTRYPOINT [&quot;/sbin/my_init&quot;,&quot;--&quot;]
CMD [&quot;jupyterhub&quot;]
</code></pre>

<p>So it appears that we&rsquo;re starting with a root image from the Fenics Project.
<a href="https://quay.io/repository/fenicsproject/stable?tag=latest&amp;tab=tags" target="_blank">Quay.io</a> has a summary of security vulnerabilities for each repository tag.</p>

<p>The one used by Dr. Umberto Villa had 3 High-Risk Vulnerabilities and 151 fixable. More modern ones such as <code>2018.1.0.r3</code> have only 57 Medium-Risk ones and 25 fixable.</p>

<p>This is a considerable advantage and thus I believe the correct place to start from. It is also evident that the developers have been working on reducing image sizes, with a clear downward-trend each time a new one comes up.
The latest does also seem to be built on top of the Ubuntu 18.04, which is exactly what we wanted!!!</p>

<p>Wonderful.</p>

<p>Okay, but before I go on building my customized version[^builderrors], I want to remember how to get the <code>hippylib-muq</code> one working. I have the Dockerhub image from <code>mparno/hippylib-muq</code> and can run it (create an instance) with</p>

<pre><code class="language-bash">docker run -td -p 80:8000 --name=labhub mparno/muq-hippylib
</code></pre>

<p>So this creates an instance that will map to port 80 (default address when you land on an IP, something we should map with sub-domains later on to have <code>classhub.math.ucdenver.edu</code> rather than ports to memorize).
This &ldquo;instance&rdquo; (container) is now created and the ports mapped, so now we have to start it.</p>

<pre><code class="language-bash">docker start labhub

# now can go to base IP address and log in! 

# later on... stop it.
docker stop labhub
</code></pre>

<p>Alright, that&rsquo;s fine and well. We have a baseline set of instructions to go off now, and can learn from.
 However, seeing as quite a lot is happening in those instructions, and no SSL security has been established, I would like to perhaps instead start with Dockerfiles from the Jupyter Project. Moreover, these will be newer versions and should come with Lab enabled already since it is finally in a stable release.</p>

<p>[^builderrors] I remember that some updates to MUQ&hellip; likely because of a lack of pinning to specific releases, caused build errors when I tried to start up my labhub. Though it might have been the initial commands, based on the readout above.</p>

<p>SO we&rsquo;ll have to do two things:</p>

<ul>
<li>Get Hub/Lab up and running with a single user based on the instructions from Project Jupyter.</li>
<li>Use this on top of the Fenics build to get <code>import dolfin</code> working inside of the Hub.</li>
<li></li>
</ul>

<p><strong>NOTE</strong> The ease of sharing memory for class-uses is actually a BRAND NEW effort from Jupyter (a week old?). <a href="https://github.com/jupyterhub/hubshare" target="_blank">See here</a>, which should remove the need for the solution we&rsquo;re building, allow for much better and more lightweight scalability.</p>

<p>I just came across <a href="https://github.com/jupyterhub/dockerspawner" target="_blank">dockerspawner</a>
which can be enabled with the following in <code>jupyterhub_config.py</code>:</p>

<pre><code>c.JupyterHub.spawner_class = 'dockerspawner.DockerSpawner'
</code></pre>

<p>More appropriate for the use case we have is <code>SystemUserSpawner</code></p>

<blockquote>
<p>If you want to spawn notebook servers for users that correspond to system users, you can use the SystemUserSpawner instead. Add the following to your jupyterhub_config.py:</p>

<p><code>c.JupyterHub.spawner_class = 'dockerspawner.SystemUserSpawner'</code>
The SystemUserSpawner will also need to know where the user home directories are on the host. By default, it expects them to be in <code>/home/&lt;username&gt;</code>, but if you want to change this, you&rsquo;ll need to further modify the <code>jupyterhub_config.py</code>. For example, the following will look for a user&rsquo;s home directory on the host system at <code>/volumes/user/&lt;username&gt;</code>:</p>

<pre><code>c.SystemUserSpawner.host_homedir_format_string = '/volumes/user/{username}'
</code></pre>

<p>For a full example of how SystemUserSpawner is used, see the <a href="https://github.com/jhamrick/compmodels-jupyterhub" target="_blank">compmodels-jupyterhub</a> (warning: old) repository (this additionally runs the JupyterHub server within a docker container, and authenticates users using GitHub OAuth).</p>
</blockquote>

<hr />

<p>I believe the correct entry-point for us will actually be <a href="https://github.com/jupyterhub/jupyterhub-deploy-docker" target="_blank">here</a>, at Project Jupyter&rsquo;s Deploy-Docker repository.</p>

<blockquote>
<p><code>jupyterhub-deploy-docker</code> provides a reference deployment of JupyterHub, a multi-user Jupyter Notebook environment, on a single host using Docker.
This deployment is NOT intended for a production environment. It is a reference implementation that does not meet traditional requirements in terms of availability nor scalability.</p>
</blockquote>

<p><img src="https://github.com/jupyterhub/jupyterhub-deploy-docker/raw/master/internal/jupyterhub-docker.png" alt="schematic" /></p>

<p>Okay, so this is actually a great solution, but it&rsquo;s the same thing more/less as the &ldquo;french&rdquo; solution, with the encryption being handled directly by Jupyterhub.</p>

<p>Since we want to be building Linux images and then running a Hub on each one, we basically just need to paste installation instructions into the Dockerfile.</p>

<pre><code>conda install -c conda-forge jupyterhub
conda install jupyterlab
</code></pre>

<h1 id="docker-jupyter-stacks">Docker Jupyter Stacks</h1>

<p>However, I then came across <a href="https://github.com/jupyter/docker-stacks" target="_blank">Jupyter Docker Stacks</a>, which appear to be a number of recipes I can start with.</p>

<p>So let&rsquo;s go ahead and try this on the server.</p>

<blockquote>
<p>Example 2: This command pulls the jupyter/datascience-notebook image tagged 3772fffc4aa4 from Docker Hub if it is not already present on the local host.
It then starts an ephemeral container running a Jupyter Notebook server and exposes the server on host port 10000. The command mounts the current working directory on the host as /home/jovyan/work in the container. The server logs appear in the terminal. Visiting http://<hostname>:10000/?token=<token> in a browser loads JupyterLab, where hostname is the name of the computer running docker and token is the secret token printed in the console. Docker destroys the container after notebook server exit, but any files written to ~/work in the container remain intact on the host.</p>

<pre><code class="language-bash">docker run --rm -p 10000:8888 -e JUPYTER_ENABLE_LAB=yes -v &quot;$PWD&quot;:/home/jovyan/work jupyter/datascience-notebook:3772fffc4aa4
</code></pre>
</blockquote>

<p>My workstation was unable to find the image locally so it began to pull it from docker-cloud. <em>This took a moment.</em> Appears to be several gb large.</p>

<p>Okay, well I managed to connect to it by visiting <code>&lt;IP&gt;:10000/?token=XXXX...XXXX</code>, where I grabbed the token from the output of the terminal window.</p>

<p>This is great functionality, but it&rsquo;s not the hub we&rsquo;re looking for. That said, the <a href="https://github.com/jupyter/docker-stacks" target="_blank">included dockerfiles</a> are very instructive.</p>

<p>Here is the dependency list. Each one is a root image of the next.</p>

<p><code>base-notebook</code> &gt; <code>minimal-notebook</code> &gt;  <code>scipy-notebook</code> &gt; <code>datascience-notebook</code></p>

<p>The last install, the [<code>datascience-notebook</code>][<a href="https://github.com/jupyter/docker-stacks/blob/master/datascience-notebook/Dockerfile" target="_blank">https://github.com/jupyter/docker-stacks/blob/master/datascience-notebook/Dockerfile</a>] includes R and Julia on top of Python. The heavy <code>HDF5</code> dependency for Julia is not included if the build is in test-mode (see line 10 and 73).
It will also link the kernels together.
As tempting as it is to start here, I&rsquo;d like to start earlier.</p>

<p>The <a href="https://github.com/jupyter/docker-stacks/blob/master/scipy-notebook/Dockerfile" target="_blank"><code>scipy-notebook</code></a> features installs of widgets and more, and is the minimum requirement for most of what we need.</p>

<p>Something I noticed was that it includes an old version of pip.
If you launch the container, it mounts whatever directory you were in when you executed the <code>docker run</code> command to a &ldquo;fake one&rdquo; inside docker (so <code>pwd</code> returns <code>/home/jovyan/work</code>).
This is actually kind of nice. If volumes of students can be mounted by the professor to have a look around, that would be great. That would, of course, require learning some docker.
Students can even install additional libraries as needed, but they will disappear next time they connect (though the files stick around!).</p>

<p>What we need to do (I think), is merge this Dockerfile with the JupyterHub deployments. I think this just comes down to configuring the authenticator correctly (and referencing Umberto&rsquo;s file above).</p>

<p>Let&rsquo;s look at the <a href="https://github.com/jupyter/docker-stacks/blob/master/base-notebook/Dockerfile" target="_blank"><code>base-notebook</code></a>, since it seems that <a href="https://github.com/jupyter/docker-stacks/blob/master/scipy-notebook/Dockerfile" target="_blank"><code>scipy-notebook</code></a> just adds bells and whistles (widgets already is calling jupyterlab extension manager).
And yes, it appears hub is installed!</p>

<pre><code># Copyright (c) Jupyter Development Team.
# Distributed under the terms of the Modified BSD License.

# Ubuntu 18.04 (bionic) from 2018-05-26
# https://github.com/docker-library/official-images/commit/aac6a45b9eb2bffb8102353c350d341a410fb169
ARG BASE_CONTAINER=ubuntu:bionic-20180526@sha256:c8c275751219dadad8fa56b3ac41ca6cb22219ff117ca98fe82b42f24e1ba64e
FROM $BASE_CONTAINER

LABEL maintainer=&quot;Jupyter Project &lt;jupyter@googlegroups.com&gt;&quot;
ARG NB_USER=&quot;jovyan&quot;
ARG NB_UID=&quot;1000&quot;
ARG NB_GID=&quot;100&quot;

USER root

# Install all OS dependencies for notebook server that starts but lacks all
# features (e.g., download as all possible file formats)
ENV DEBIAN_FRONTEND noninteractive
RUN apt-get update &amp;&amp; apt-get -yq dist-upgrade \
 &amp;&amp; apt-get install -yq --no-install-recommends \
    wget \
    bzip2 \
    ca-certificates \
    sudo \
    locales \
    fonts-liberation \
 &amp;&amp; rm -rf /var/lib/apt/lists/*

RUN echo &quot;en_US.UTF-8 UTF-8&quot; &gt; /etc/locale.gen &amp;&amp; \
    locale-gen

# Configure environment
ENV CONDA_DIR=/opt/conda \
    SHELL=/bin/bash \
    NB_USER=$NB_USER \
    NB_UID=$NB_UID \
    NB_GID=$NB_GID \
    LC_ALL=en_US.UTF-8 \
    LANG=en_US.UTF-8 \
    LANGUAGE=en_US.UTF-8
ENV PATH=$CONDA_DIR/bin:$PATH \
    HOME=/home/$NB_USER

ADD fix-permissions /usr/local/bin/fix-permissions
# Create jovyan user with UID=1000 and in the 'users' group
# and make sure these dirs are writable by the `users` group.
RUN groupadd wheel -g 11 &amp;&amp; \
    echo &quot;auth required pam_wheel.so use_uid&quot; &gt;&gt; /etc/pam.d/su &amp;&amp; \
    useradd -m -s /bin/bash -N -u $NB_UID $NB_USER &amp;&amp; \
    mkdir -p $CONDA_DIR &amp;&amp; \
    chown $NB_USER:$NB_GID $CONDA_DIR &amp;&amp; \
    chmod g+w /etc/passwd &amp;&amp; \
    fix-permissions $HOME &amp;&amp; \
    fix-permissions $CONDA_DIR

USER $NB_UID

# Setup work directory for backward-compatibility
RUN mkdir /home/$NB_USER/work &amp;&amp; \
    fix-permissions /home/$NB_USER

# Install conda as jovyan and check the md5 sum provided on the download site
ENV MINICONDA_VERSION 4.5.11
RUN cd /tmp &amp;&amp; \
    wget --quiet https://repo.continuum.io/miniconda/Miniconda3-${MINICONDA_VERSION}-Linux-x86_64.sh &amp;&amp; \
    echo &quot;e1045ee415162f944b6aebfe560b8fee *Miniconda3-${MINICONDA_VERSION}-Linux-x86_64.sh&quot; | md5sum -c - &amp;&amp; \
    /bin/bash Miniconda3-${MINICONDA_VERSION}-Linux-x86_64.sh -f -b -p $CONDA_DIR &amp;&amp; \
    rm Miniconda3-${MINICONDA_VERSION}-Linux-x86_64.sh &amp;&amp; \
    $CONDA_DIR/bin/conda config --system --prepend channels conda-forge &amp;&amp; \
    $CONDA_DIR/bin/conda config --system --set auto_update_conda false &amp;&amp; \
    $CONDA_DIR/bin/conda config --system --set show_channel_urls true &amp;&amp; \
    $CONDA_DIR/bin/conda install --quiet --yes conda=&quot;${MINICONDA_VERSION%.*}.*&quot; &amp;&amp; \
    $CONDA_DIR/bin/conda update --all --quiet --yes &amp;&amp; \
    conda clean -tipsy &amp;&amp; \
    rm -rf /home/$NB_USER/.cache/yarn &amp;&amp; \
    fix-permissions $CONDA_DIR &amp;&amp; \
    fix-permissions /home/$NB_USER

# Install Tini
RUN conda install --quiet --yes 'tini=0.18.0' &amp;&amp; \
    conda list tini | grep tini | tr -s ' ' | cut -d ' ' -f 1,2 &gt;&gt; $CONDA_DIR/conda-meta/pinned &amp;&amp; \
    conda clean -tipsy &amp;&amp; \
    fix-permissions $CONDA_DIR &amp;&amp; \
    fix-permissions /home/$NB_USER

# Install Jupyter Notebook, Lab, and Hub
# Generate a notebook server config
# Cleanup temporary files
# Correct permissions
# Do all this in a single RUN command to avoid duplicating all of the
# files across image layers when the permissions change
RUN conda install --quiet --yes \
    'notebook=5.7.2' \
    'jupyterhub=0.9.4' \
    'jupyterlab=0.35.4' &amp;&amp; \
    conda clean -tipsy &amp;&amp; \
    jupyter labextension install @jupyterlab/hub-extension@^0.12.0 &amp;&amp; \
    npm cache clean --force &amp;&amp; \
    jupyter notebook --generate-config &amp;&amp; \
    rm -rf $CONDA_DIR/share/jupyter/lab/staging &amp;&amp; \
    rm -rf /home/$NB_USER/.cache/yarn &amp;&amp; \
    fix-permissions $CONDA_DIR &amp;&amp; \
    fix-permissions /home/$NB_USER

USER root

EXPOSE 8888
WORKDIR $HOME

# Configure container startup
ENTRYPOINT [&quot;tini&quot;, &quot;-g&quot;, &quot;--&quot;]
CMD [&quot;start-notebook.sh&quot;]

# Add local files as late as possible to avoid cache busting
COPY start.sh /usr/local/bin/
COPY start-notebook.sh /usr/local/bin/
COPY start-singleuser.sh /usr/local/bin/
COPY jupyter_notebook_config.py /etc/jupyter/
RUN fix-permissions /etc/jupyter/

# Switch back to jovyan to avoid accidental container runs as root
USER $NB_UID
</code></pre>

<p>It seems that the implementation at the <a href="https://github.com/jupyterhub/jupyterhub-deploy-docker" target="_blank">Deploy-Docker</a> repository actually handles multi-users, and you can CHOOSE ANY OF the aforementioned builds from <a href="https://hub.docker.com/u/jupyter" target="_blank">Jupyter&rsquo;s Page on Docker Cloud</a></p>

<p>I think I will try this approach. The key difference here is that users are isolated through where docker mounts their directories, not through permissions.</p>

<p>So the idea is that you have a Linux machine running docker. All the students files are in some directory there. The Hub spawns up a Docker container on-demand for each student, mounting them appropriately. A teacher can access the files since they are simply the user that is using Docker. (anyone with sudo permissions on the UNIX machine? or just part of the correct usergroup? Joe can help there.) When the teachers log in, their accounts get mounted in a place they can see the whole class, but not other instructor&rsquo;s classes!</p>

<p><em>Virtualization can be used to segment classes, or they can run together. It doesn&rsquo;t matter. Port-forwarding with sub-addresses can be used to direct to the correct hub for login. One hub runs per class. One docker instance manages all the hubs.</em></p>

<p>I&rsquo;m going to try it this way first, rather than the isolated UNIX-machine way.</p>

<hr />

<h1 id="the-correct-way">The &ldquo;Correct Way&rdquo;</h1>

<p>We will be using <a href="https://github.com/jupyterhub/dockerspawner" target="_blank"><code>dockerspawner</code></a>, and the directions in their <code>README</code>.</p>

<p><em>Actually&hellip;</em>
It seems this is what the point of <a href="https://github.com/jupyterhub/jupyterhub-deploy-docker" target="_blank">Deploy Docker</a> is. Slight modifications are made so that the <code>dockerspawner</code> launches up our chosen base-image!</p>

<p>Choose a pinned image on <a href="https://hub.docker.com/u/jupyter" target="_blank">docker cloud</a> based on the builds from the <a href="https://github.com/jupyter/docker-stacks" target="_blank">stacks on github</a>.</p>

<p>Since we really need all the stuff included in the  <a href="https://hub.docker.com/r/jupyter/scipy-notebook/tags" target="_blank"><code>scipy</code></a> stack, and these images are no smaller than 2GB, we might as well spring for the <a href="https://hub.docker.com/r/jupyter/datascience-notebook/tags" target="_blank"><code>datascience</code></a> stack since they are the same size and include R and Julia, which our colleagues may appreciate.</p>

<p>As of this writing, here is a recent tag: <code>7254cdcfa22b</code></p>

<p>when running, be aware that no sudo priviledges will be granted. <code>-e GRANT_SUDO=yes</code> needs to be included upon docker run.</p>

<p>So, following the Deploy-Docker Dockerfile, I can see that it is running relatively recent versions of <code>jupyterhub</code> and <code>dockerspawner</code>, despite many files being unchanged for years. That&rsquo;s actually kind of promising for maintenance purposes.</p>

<p>Starting from Zero&hellip; SSH into my main machine. Move into a directory to perform the cloning. Needed to first run</p>

<p><code>sudo apt install docker-compose</code></p>

<pre><code>git clone https://github.com/jupyterhub/jupyterhub-deploy-docker.git
cd jupyterhub-deploy-docker

mkdir -p secrets
cd secrets
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout mykey.key -out mycert.pem

# bad idea?
mv mycert.pem jupyterhub.crt 
mv mykey.key jupyterhub.key

cd ..
mv .env

# change line 19 to 
DOCKER_NOTEBOOK_IMAGE=jupyter/datascience-notebook:7254cdcfa22b

</code></pre>

<p>In <code>jupyterhub_config.py</code> add the lines</p>

<pre><code>c.DockerSpawner.environment = { 'JUPYTER_ENABLE_LAB': 'yes' }
</code></pre>

<p>Now we face the authentication problem. We did generate a self-signed cert (hopefully), but the IP address of my workstation is not public. For extra security, best to keep it this way.</p>

<p>We want to change authentication to users&hellip;
The problem is that I don&rsquo;t want to be setting up github users accounts. Lines 56-57 in <code>juptyerhub_config.py</code> are the problem:</p>

<pre><code>c.JupyterHub.authenticator_class = 'oauthenticator.GitHubOAuthenticator'
c.GitHubOAuthenticator.oauth_callback_url = os.environ['OAUTH_CALLBACK_URL']
</code></pre>

<p><em>I think by commenting it out, PAMAuthenticator is default. Should be good enough?</em>
Well now if we change this we will have to create user accounts to log in with.</p>

<p>Let&rsquo;s create a userlist file in the root directory <code>vim userlist</code></p>

<pre><code>michael admin
troy admin
varis
</code></pre>

<p>Now to actually create these users. Let&rsquo;s see how this was done in <code>hippylib-hub</code>:</p>

<pre><code class="language-bash">#!/bin/bash

echo &quot;Update Lab materials from GitHub&quot;
cd /home/fenics/Installations/labs &amp;&amp; git pull

echo &quot;Creating ${NUMBER_OF_USERS} new users...&quot;
for ((i = 0; i &lt; ${NUMBER_OF_USERS}; i++));
do
    password=&quot;Breckenridge${i}_g2s3&quot;
    useradd &quot;user${i}&quot; -m -s /bin/bash
    echo &quot;user${i}:${password}&quot; | chpasswd user${i}
    
    cp -rf /home/fenics/.jupyter /home/user${i}/.jupyter
    chown -R user${i} /home/user${i}/.jupyter
    chmod -R u+rX /home/user${i}/.jupyter
    
    cp -r /home/fenics/Installations/labs/Labs /home/user${i}/
    chown -R user${i} /home/user${i}/Labs
    chmod -R u+rX /home/user${i}/Labs
 
    echo &quot;Created user${i} with password ${password}&quot;
done
</code></pre>

<p>So we have to translate this into our <code>Dockerfile.jupyterhub</code> file.</p>

<pre><code># Copyright (c) Jupyter Development Team.
# Distributed under the terms of the Modified BSD License.
ARG JUPYTERHUB_VERSION
FROM jupyterhub/jupyterhub-onbuild:$JUPYTERHUB_VERSION

# Install dockerspawner, oauth, postgres
RUN /opt/conda/bin/conda install -yq psycopg2=2.7 &amp;&amp; \
    /opt/conda/bin/conda clean -tipsy &amp;&amp; \
    /opt/conda/bin/pip install --no-cache-dir \
        oauthenticator==0.8.* \
        dockerspawner==0.9.*

# We make additions here.
RUN useradd michael -m -s /bin/bash
RUN echo &quot;michael:test_password&quot; | chpasswd michael
RUN echo &quot;Created user Michael&quot;

# Copy TLS certificate and key
ENV SSL_CERT /srv/jupyterhub/secrets/jupyterhub.crt
ENV SSL_KEY /srv/jupyterhub/secrets/jupyterhub.key
COPY ./secrets/*.crt $SSL_CERT
COPY ./secrets/*.key $SSL_KEY
RUN chmod 700 /srv/jupyterhub/secrets &amp;&amp; \
    chmod 600 /srv/jupyterhub/secrets/*

COPY ./userlist /srv/jupyterhub/userlist
</code></pre>

<p>Let&rsquo;s try it?? The instructions say all I need now is to run <code>make build</code> in the root directory.</p>

<p>Failed. Commenting out lines referencing GitHub in <code>Makefile</code> (lines 23-24) and <code>secrets/oauth.env</code> (line 48).</p>

<p>I dont have any clue what is going on in the secrets files. Doing my best but unable to make it work.</p>

<p>Okay let&rsquo;s try this.</p>

<pre><code>docker run -p 8000:8000 -d --name jupyterhub jupyterhub/jupyterhub jupyterhub
</code></pre>

<p>My errors seem to be caused by outdated docker. Since I was running on 16.04, the apt repositories didn&rsquo;t have newer versions, so I needed to manually add the updates:</p>

<pre><code>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
sudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot;
sudo apt-get update
apt-cache policy docker-ce
sudo apt-get install -y docker-ce
</code></pre>

<p>after setting
<code>ARG JUPYTERHUB_VERSION=0.90</code> in the header, I was able to finally run <code>make build</code> (but who knows how it will work).</p>

<p>There&rsquo;s no particular reason Hub has to run in a docker container. It can still spawn up new processes with docker.</p>

<p>Once <code>make build</code> finished, I had to run <code>docker-compose up -d</code></p>

<p><code>docker ps</code> revealed two containers. One is a database of some sort (what was causing me trouble with installation earlier before I faked the files).</p>

<p>Logs are showing me that my problem is indeed with <code>POSTGRES_PASSWORD</code> &hellip; and this part is certainly a bit above my paygrade.</p>

          </div>

          


<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/dev/">dev</a>
  
  <a class="badge badge-light" href="/tags/jupyter/">jupyter</a>
  
  <a class="badge badge-light" href="/tags/openscience/">openscience</a>
  
  <a class="badge badge-light" href="/tags/docker/">docker</a>
  
</div>



        </div>

        <div class="body-footer">
          Last updated on Jan 1, 2019
        </div>

      </article>

      <footer class="site-footer">
  
  <p class="powered-by">
    <a href="/privacy/">Privacy Policy</a>
  </p>
  

  <p class="powered-by">
    &copy; 2018 Michael Pilosov &middot; 

    
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic</a> +
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>

    
  </p>
</footer>


    </main>
  </div>
</div>

    

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
        
      

      
      
    

    
    

    
    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    
    
    
    
    
    
    <script src="/js/academic.min.d037ee5294b166a79dec317c58aea9cc.js"></script>

    

  </body>
</html>


